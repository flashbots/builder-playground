package playground

import (
	"os"
	"testing"
)

func TestEnodeGeneration(t *testing.T) {
	// Test that the enodes generated by output are deterministic
	o1 := newTestOutput(t)
	o2 := newTestOutput(t)

	for i := 0; i < 10; i++ {
		if o1.GetEnodeAddr().ID() != o2.GetEnodeAddr().ID() {
			t.Fatalf("enode IDs are not the same")
		}
	}
}

func newTestOutput(t *testing.T) *output {
	dir, err := os.MkdirTemp("/tmp", "test-output")
	if err != nil {
		t.Fatalf("failed to create temporal folder: %v", err)
	}
	defer os.RemoveAll(dir)

	o := &output{
		dst: dir,
	}
	return o
}
